<template>
<div class="vulnerabilityDetails">
    <a-row style="margin:0" :gutter="[{ xs: 8, sm: 16, md: 24, xs: 32 },{xs: 8, sm: 16, md: 24, lg: 32 }]">
        <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-subject">
            <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-subject-title">漏洞信息：</a-col>
            <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-subject-list">
                <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-subject-list-basic">
                    <a-col :xs="{ span: 24}" :md="{ span: 10}" :lg="{ span: 8}" :xl="{ span: 6}" :xxl="{ span: 4}" class="vulnerabilityDetails-subject-list-basic-map">
                        <div class="vulnerabilityDetails-subject-list-basic-map-pie" ref="basic"></div>
                    </a-col>
                    <a-col :xs="{ span: 24}" :md="{ span: 14}" :lg="{ span: 16}" :xl="{ span: 18}" :xxl="{ span: 20}" class="vulnerabilityDetails-subject-list-basic-text">
                        <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-subject-list-basic-text-catalog">疑似敏感目录: <span style="color:#fff;margin-left:20px">{{list.catalog}}</span></a-col>
                        <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-subject-list-basic-text-url">所属网站: <span style="margin-left:20px">{{list.url}}</span></a-col>
                    </a-col>
                </a-col>
                <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-subject-list-describe">
                    漏洞描述:<span style="margin-left:40px">{{list.describe}}</span>
                </a-col>
                <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-subject-list-harm">
                    漏洞危害:<span style="margin-left:40px">{{list.harm}}</span>
                </a-col>
                <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-subject-list-details">
                    漏洞细节:<span style="margin-left:40px">{{list.details}}</span>
                </a-col>
                <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-subject-list-proposal">
                    修复建议:<span style="margin-left:40px">{{list.proposal}}</span>
                </a-col>
            </a-col>
        </a-col>
    </a-row>
</div>
</template>

<script>
export default {
    name: "vulnerabilityDetails",
    data() {
        return {
            basicMap: {},
            list: {
                catalog: 'Scripting(Possible_Sensitive_Directories.script',
                url: 'baidu.cpm',
                describe: '经过窒息查找后，找到疑似敏感目录。此目录不直接从网站链接。此检查寻找常见的敏感资源，如备份目录，数据库转储，管理页面，临时目录。这些目录每一个都可以帮助攻击者更多的了解他的目标',
                harm: '此目录可能会暴露敏感信息，这可能有助于恶意用户准备更高级的攻击',
                details: '无懈可击',
                proposal: '建议你下地狱忏悔，为什么就你有问题'
            }
        };
    },
    mounted() {
        this.handleGetmedusa_query()
        let _this = this;
        _this.fnDrawLine();
        window.onresize = function () {
            _this.basicMap.resize();
        };

    },
    methods: {

        fnDrawLine() {
            this.basicMap = this.$echarts.init(this.$refs.basic);
            this.basicMap.setOption({
                series: [{
                    name: "访问来源",
                    type: "pie",
                    radius: ["70%", "90%"],
                    left: "center",
                    avoidLabelOverlap: false,
                    label: {
                        show: true,
                        position: "center",
                        fontSize: "24",
                        fontWeight: "bold",
                    },
                    itemStyle: {
                        color: "rgba(54,163,255,1)",
                    },
                    data: [{
                        value: 100,
                        name: "低危",
                    }, ],
                }, ],
            });
        },

        handleGetmedusa_query() {
            let params = {
                token: localStorage.getItem('storeToken'),
                scan_info_id: this.$store.state.scan_info_id
            }
            this.$api.medusa_query(params).then((res) => {
                console.log(res)
            })
        }
    },
};
</script>

<style lang="scss">
.vulnerabilityDetails {
    background: rgb(46, 64, 81);

    .vulnerabilityDetails-subject {
        .vulnerabilityDetails-subject-title {
            min-width: 288px;
            font-size: 26px;
            font-weight: 800;
            color: #fff;
        }

        .vulnerabilityDetails-subject-list {
            .vulnerabilityDetails-subject-list-basic {
                .vulnerabilityDetails-subject-list-basic-map {
                    min-width: 224px;
                    min-height: 190px;
                    height: 1rem;

                    .vulnerabilityDetails-subject-list-basic-map-pie {
                        width: 100%;
                        height: 100%;
                    }
                }

                .vulnerabilityDetails-subject-list-basic-text {
                    min-width: 224px;
                    font-size: 16px;
                    font-weight: 400;
                    color: #fff;

                    .vulnerabilityDetails-subject-list-basic-text-catalog {
                        color: rgba(54, 163, 255, 1);
                    }

                    .vulnerabilityDetails-subject-list-basic-text-url {
                        color: #fff;
                    }
                }
            }

            .vulnerabilityDetails-subject-list-describe,
            .vulnerabilityDetails-subject-list-harm,
            .vulnerabilityDetails-subject-list-proposal {
                min-width: 224px;
                font-size: 16px;
                font-weight: 400;
                color: #fff;
            }

            .vulnerabilityDetails-subject-list-details {
                min-width: 224px;
                font-size: 16px;
                font-weight: 400;
                color: #fff;
                background: rgba(42, 74, 105, 1);
                border-radius: 5px;
            }
        }
    }
}
</style>
