<template>
<div class="vulnerabilityDetails">
    <a-row :gutter="[
        { xs: 8, sm: 16, md: 24, xs: 8 },
        { xs: 4, sm: 8, md: 16, lg: 24 },
      ]">
        <a-col :xs="{ span: 24 }" :lg="{ span: 24 }">
            <!-- <a-col :xs="{ span: 24 }" :lg="{ span: 24 }" class="vulnerabilityDetails-title">æ¼æ´è¯¦æƒ…:</a-col>-->
            <a-col :xs="{ span: 24 }" :lg="{ span: 24 }" class="vulnerabilityDetails-nav">
                <a-col :xs="{ span: 24 }" :lg="{ span: 24 }" class="vulnerabilityDetails-nav-name">
                    åŸºç¡€ä¿¡æ¯
                </a-col>
                <a-col :xs="{ span: 24 }" :lg="{ span: 24 }" class="vulnerabilityDetails-nav-best">
                    <a-col :xs="{ span: 8 }" style="margin-top: 5px">
                        <span>æ¼æ´å:</span><span class="format">{{ vulnerabilityList.name }}</span>
                    </a-col>
                    <a-col :xs="{ span: 8 }" style="margin-top: 5px">
                        <span>ID:</span><span class="format">{{ vulnerabilityList.scan_info_id }}</span>
                    </a-col>
                    <a-col :xs="{ span: 8 }" style="margin-top: 5px">
                        <span>ä¸Šçº§ID:</span><span class="format">{{
                vulnerabilityList.active_scan_id
              }}</span>
                    </a-col>
                    <a-col :xs="{ span: 8 }" style="margin-top: 5px">
                        <span>URL:</span><span class="format">{{ vulnerabilityList.url }}</span>
                    </a-col>
                    <a-col :xs="{ span: 8 }" style="margin-top: 5px">
                        <span>æ¼æ´ç»„ä»¶:</span><span class="format">{{ vulnerabilityList.affects }}</span>
                    </a-col>
                    <a-col :xs="{ span: 8 }" style="margin-top: 5px">
                        <span>æ‰«æåˆ°çš„æ—¶é—´:</span><span class="format">{{ vulnerabilityList.timestamp }}</span>
                    </a-col>
                    <a-col :xs="{ span: 8 }" style="margin-top: 5px">
                        <span>æ¼æ´ç­‰çº§:</span><span class="format" :class="LV">{{
                vulnerabilityList.rank
              }}</span>
                    </a-col>
                    <a-col :xs="{ span: 24 }" style="margin-top: 5px">
                        <span>ç‰ˆæœ¬:</span><span class="format">{{ vulnerabilityList.version }}</span>
                    </a-col>
                </a-col>
            </a-col>
            <a-col :xs="{ span: 24 }" :lg="{ span: 24 }" class="vulnerabilityDetails-nav">
                <a-col :xs="{ span: 24 }" :lg="{ span: 24 }" class="vulnerabilityDetails-nav-name">
                    è¯¦ç»†ä¿¡æ¯
                </a-col>
                <a-col :xs="{ span: 24 }" :lg="{ span: 24 }" class="vulnerabilityDetails-nav-solution">
                    <a-col :xs="{ span: 24 }" style="margin-top: 5px">
                        <div class="class_title">æ¼æ´æè¿°:</div>
                        <div class="format">{{ vulnerabilityList.desc_content }}</div>
                    </a-col>
                    <a-col :xs="{ span: 24 }" style="margin-top: 5px">
                        <div class="class_title">æ¼æ´è¯¦æƒ…:</div>
                        <div class="format">{{ vulnerabilityList.details }}</div>
                    </a-col>
                    <a-col :xs="{ span: 24 }" style="margin-top: 5px">
                        <div class="class_title">ä¿®å¤å»ºè®®:</div>
                        <div class="format">{{ vulnerabilityList.suggest }}</div>
                    </a-col>
                </a-col>
            </a-col>
        </a-col>
    </a-row>
</div>
</template>

<script>
export default {
    name: "vulnerabilityDetails",
    data() {
        return {
            vulnerabilityList: {},
            LV: "",
        };
    },
    mounted() {
        this.handleGetmedusa_query();
    },
    methods: {
        handleReturnSSR(e) {
            switch (e) {
                case "é«˜å±":
                    return "SSR";
                    break;
                case "ä¸­å±":
                    return "SR";
                    break;
                case "ä½å±":
                    return "UR";
                    break;
            }
        },
        handleGetmedusa_query() {
            if (this.$store.state.scan_info_id != "null") {
                let params = {
                    token: localStorage.getItem("storeToken"),
                    scan_info_id: this.$store.state.scan_info_id,
                };
                this.$api.medusa_query(params).then((res) => {
                    switch (res.code) {
                        case 200:
                            res.message.map((item) => {
                                this.vulnerabilityList = {
                                    name: item.name, //æ¼æ´åå­—
                                    active_scan_id: item.active_scan_id, //ä¸Šçº§id
                                    scan_info_id: item.scan_info_id, //å•å‰id
                                    affects: item.affects, //æ¼æ´ç»„ä»¶
                                    algroup: item.algroup, //è‹±æ–‡å
                                    desc_content: item.desc_content, //æ¼æ´æè¿°
                                    details: item.details, //æ¼æ´è¯¦æƒ…
                                    rank: item.rank, //æ¼æ´ç­‰çº§
                                    url: item.url, //ç›®æ ‡åœ°å€
                                    version: item.version, //ç‰ˆæœ¬
                                    timestamp: item.timestamp, //æ‰«æåˆ°çš„æ—¶é—´
                                    suggest: item.suggest, //ä¿®å¤å»ºè®®
                                };
                                this.LV = this.handleReturnSSR(item.rank);
                            });
                            break;
                        case 404:
                            this.$message.error("æ•°æ®åº“GGäº†ğŸˆ");
                            break;
                        case 403:
                            this.$message.error("å°å®è´è¿™æ˜¯éæ³•æŸ¥è¯¢å“¦(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§");
                            break;
                        case 169:
                            this.$message.error("èé…±è¢«ç©åå•¦(>^Ï‰^<)å–µ");
                            break;
                        case 500:
                            this.$message.error("è¯·ä½¿ç”¨Postè¯·æ±‚");
                            break;
                    }
                });
            } else if (this.$store.state.active_scan_id != "null") {
                this.$message.warning("è¯·ä»æ¼æ´åˆ—è¡¨æŸ¥è¯¢è¿›å…¥,è·³è½¬æ¼æ´åˆ—è¡¨æŸ¥è¯¢ä¸­...");
                this.$router.push("/layout/siteInformation/siteScan");
            } else {
                this.$message.warning("è¯·ä»ç«™ç‚¹æ‰«æè¿›å…¥,è·³è½¬ç«™ç‚¹æ‰«æä¸­...");
                this.$router.push("/layout/siteInformation");
            }
        },
    },
};
</script>

<style lang="scss" scoped>
$background: #fff;
$color: #51c51a;

.vulnerabilityDetails {
    margin: 0;
    padding: 20px;
    padding-top: 15px;

    .vulnerabilityDetails-title {
        font-size: 18px;
        color: $color;
    }

    .vulnerabilityDetails-nav {

        min-width: 280px;
        padding: 10px;
        margin-top: 10px;
        margin-bottom: 10px;
        color: $color;
        border-radius: 15px;
        text-align: left;
        background: $background;
        font-size: 14px;

        .vulnerabilityDetails-nav-name {
            font-weight: 800;
            color: $color;
            font-size: 25px;
            border-bottom: 1px solid #ccc;
        }

        .vulnerabilityDetails-nav-best {
            color: $color;
            font-size: 18px;

            .format {
                margin-left: 10px;
                word-break: break-all;
                color: #000
            }

            .SSR {
                color: #ff6347;
                font-weight: 800;
            }

            .SR {
                color: #ff8000;
                font-weight: 800;
            }

            .UR {
                color: #03b7c9;
                font-weight: 800;
            }
        }

        .vulnerabilityDetails-nav-solution {
            color: $color;
            font-size: 18px;

            .class_title {
                border-left: 3px solid $color;
                padding-left: 5px;
                font-weight: 800;
            }

            .format {
                margin-top: 15px;
                margin-left: 10px;
                word-break: break-all;
                color: #000;
                background: rgb(245, 245, 245);
                border: 1px solid rgb(203, 203, 203);
                border-radius: 10px;
                padding: 5px;
            }

        }
    }
}
</style>
